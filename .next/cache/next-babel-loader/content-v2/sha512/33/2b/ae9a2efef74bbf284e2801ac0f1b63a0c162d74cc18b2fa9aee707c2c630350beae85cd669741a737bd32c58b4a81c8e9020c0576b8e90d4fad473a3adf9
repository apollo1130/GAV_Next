{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport DashboardLayout from '../../layouts/Dashboard';\nimport { useState, useEffect, createFactory } from \"react\";\nimport PersonalInfo from '../../components/SupplierRegistration/PersonalInfo';\nimport UploadPhotos from '../../components/SupplierRegistration/UploadPhotos';\nimport VehicleDetails from '../../components/SupplierRegistration/VehicleDetails';\nimport UploadVehiclePhotos from '../../components/SupplierRegistration/UploadVehiclePhotos';\nimport { getSession } from 'next-auth/client';\nimport { getMe } from '../../utils/providers';\nimport { ToastContainer } from 'react-toastify';\nimport { recoverOwner } from '../../api/owner/recoverOwner';\nimport { getCep } from '../../api/driver/updateDriver';\nimport { useRouter } from 'next/router';\nimport { notify } from '../../utils/common';\nimport { FullPageLoader } from '../../components/UI/Loader';\nimport { createFile } from '../../api/files/createFiles';\nimport { createCar } from '../../api/owner/cars/createCar';\n\nconst SupplierRegistrationForm = () => {\n  const router = useRouter();\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: owner,\n    1: setOwner\n  } = useState({});\n  const {\n    0: activeStep,\n    1: setActiveStep\n  } = useState(0);\n  const {\n    0: nome,\n    1: setnome\n  } = useState(\"\");\n  const {\n    0: email,\n    1: setemail\n  } = useState(\"\");\n  const {\n    0: celular,\n    1: setcelular\n  } = useState(\"\");\n  const {\n    0: cpf,\n    1: setcpf\n  } = useState(\"\");\n  const {\n    0: cep,\n    1: setcep\n  } = useState(\"\");\n  const {\n    0: estado,\n    1: setestado\n  } = useState(\"\");\n  const {\n    0: bairro,\n    1: setbairro\n  } = useState(\"\");\n  const {\n    0: rua,\n    1: setrua\n  } = useState(\"\");\n  const {\n    0: numero,\n    1: setnumero\n  } = useState(\"\");\n  const {\n    0: cidade,\n    1: setcidade\n  } = useState(\"\");\n  const {\n    0: complemento,\n    1: setcomplemento\n  } = useState(\"\");\n  const {\n    0: cidadeId,\n    1: setCidadeId\n  } = useState(\"\");\n  const {\n    0: processing,\n    1: setProcessing\n  } = useState(false);\n  const {\n    0: marcaCar,\n    1: setMarcaCar\n  } = useState(\"aa\");\n  const {\n    0: modeloCar,\n    1: setModeloCar\n  } = useState(\"a\");\n  const {\n    0: anoCar,\n    1: setAnoCar\n  } = useState(\"2021\");\n  const {\n    0: placaCar,\n    1: setPlacaCar\n  } = useState(\"a\");\n  const {\n    0: cepCar,\n    1: setCepCar\n  } = useState(\"a\");\n  const {\n    0: estadoCar,\n    1: setEstadoCar\n  } = useState(\"a\");\n  const {\n    0: cidadeCar,\n    1: setCidadeCar\n  } = useState(\"a\");\n  const {\n    0: ruaCar,\n    1: setRuaCar\n  } = useState(\"a\");\n  const {\n    0: semanaCar,\n    1: setSemanaCar\n  } = useState(\"a\");\n  const {\n    0: caucaoCar,\n    1: setCaucaoCar\n  } = useState(\"a\");\n  const {\n    0: diariaCar,\n    1: setDiariaCar\n  } = useState(\"a\");\n  const {\n    0: numeroCar,\n    1: setNumeroCar\n  } = useState(\"a\");\n  const {\n    0: complementoCar,\n    1: setComplementoCar\n  } = useState(\"a\");\n  const {\n    0: bairroCar,\n    1: setBairroCar\n  } = useState(\"a\");\n  const {\n    0: cidadeIdCar,\n    1: setCidadeIdCar\n  } = useState(\"a\");\n  const {\n    0: frontalId,\n    1: setFrontalId\n  } = useState(\"\");\n  const {\n    0: frontalUrl,\n    1: setFrontalUrl\n  } = useState(\"\");\n  const {\n    0: loadingFrontal,\n    1: setLoadingFrontal\n  } = useState(false);\n  const {\n    0: lateralDireitaId,\n    1: setLateralDireitaId\n  } = useState(\"\");\n  const {\n    0: lateralDireitaUrl,\n    1: setLateralDireitaUrl\n  } = useState(\"\");\n  const {\n    0: loadingLateralDireita,\n    1: setLoadingLateralDireita\n  } = useState(false);\n  const {\n    0: lateralEsquerdaId,\n    1: setLateralEsquerdaId\n  } = useState(\"\");\n  const {\n    0: lateralEsquerdaUrl,\n    1: setLateralEsquerdaUrl\n  } = useState(\"\");\n  const {\n    0: loadingLateralEsquerda,\n    1: setLoadingLateralEsquerda\n  } = useState(false);\n  const {\n    0: fundoId,\n    1: setFundoId\n  } = useState(\"\");\n  const {\n    0: fundoUrl,\n    1: setFundoUrl\n  } = useState(\"\");\n  const {\n    0: loadingFundo,\n    1: setLoadingFundo\n  } = useState(false);\n  const {\n    0: painelInternoId,\n    1: setPainelInternoId\n  } = useState(\"\");\n  const {\n    0: painelInternoUrl,\n    1: setPainelInternoUrl\n  } = useState(\"\");\n  const {\n    0: loadingPainelInterno,\n    1: setLoadingPainelInterno\n  } = useState(false);\n  const {\n    0: carProcessing,\n    1: setCarProcessing\n  } = useState(false);\n  useEffect(async () => {\n    setLoading(true);\n    const data = await recoverOwner({}, () => {\n      setLoading(false);\n    });\n\n    if (data) {\n      console.log(data);\n      setOwner(data);\n      setnome(data.nome);\n      setemail(data.email);\n      setcelular(data.celular);\n\n      if (data.pessoa_fisica && data.pessoa_fisica.cpf) {\n        setcpf(data.pessoa_fisica.cpf);\n      }\n\n      if (data.endereco.length) {\n        const addr = data.endereco[0];\n\n        if (addr.cidade && addr.cidade.descricao) {\n          setcidade(addr.cidade.descricao);\n          setCidadeId(addr.cidade.id);\n        }\n\n        if (addr.cidade && addr.cidade.estado && addr.cidade.estado.descricao) {\n          setestado(addr.cidade.estado.descricao);\n        }\n\n        if (addr.cep) {\n          setcep(addr.cep);\n        }\n\n        if (addr.bairro) {\n          setbairro(addr.bairro);\n        }\n\n        if (addr.logradouro) {\n          setrua(addr.logradouro);\n        }\n\n        if (addr.numero) {\n          setnumero(addr.numero);\n        }\n\n        if (addr.complemento) {\n          setcomplemento(addr.complemento);\n        }\n      }\n    }\n\n    if (router.query && router.query.step) {\n      setActiveStep(parseInt(router.query.step));\n    } else {\n      setActiveStep(2);\n    }\n  }, []);\n\n  const handleOwner = async e => {\n    const name = e.target.name;\n    const value = e.target.value;\n\n    switch (name) {\n      case \"nome\":\n        setnome(value);\n        break;\n\n      case \"email\":\n        setemail(value);\n        break;\n\n      case \"celular\":\n        setcelular(value);\n        break;\n\n      case \"cpf\":\n        setcpf(value);\n        break;\n\n      case \"cep\":\n        console.log(\"value = \", value);\n        setcep(value);\n        setLoading(true);\n        const addr = await getCep(value);\n\n        if (addr) {\n          console.log(\"add = \", addr);\n          setbairro(addr.bairro);\n          setrua(addr.logradouro);\n          setcidade(addr.cidade.descricao);\n          setestado(addr.cidade.estado.descricao);\n          setCidadeId(addr.cidade.id);\n        }\n\n        setLoading(false);\n        break;\n\n      case \"estado\":\n        setestado(value);\n        break;\n\n      case \"bairro\":\n        setbairro(value);\n        break;\n\n      case \"rua\":\n        setrua(value);\n        break;\n\n      case \"cidade\":\n        setcidade(value);\n        break;\n\n      case \"numero\":\n        setnumero(value);\n        break;\n\n      case \"complemento\":\n        setcomplemento(value);\n        break;\n    }\n  };\n\n  const handleCarInput = async e => {\n    const name = e.target.name;\n    const value = e.target.value;\n\n    switch (name) {\n      case \"marca\":\n        setMarcaCar(value);\n        break;\n\n      case \"modelo\":\n        setModeloCar(value);\n        break;\n\n      case \"ano\":\n        setAnoCar(value);\n        break;\n\n      case \"placa\":\n        setPlacaCar(value);\n        break;\n\n      case \"cep\":\n        console.log(\"value = \", value);\n        setCepCar(value);\n        const addr = await getCep(value);\n\n        if (addr) {\n          console.log(\"add = \", addr);\n          setBairroCar(addr.bairro);\n          setRuaCar(addr.logradouro);\n          setCidadeCar(addr.cidade.descricao);\n          setEstadoCar(addr.cidade.estado.descricao);\n          setCidadeIdCar(addr.cidade.id);\n        }\n\n        break;\n\n      case \"estado\":\n        setEstadoCar(value);\n        break;\n\n      case \"rua\":\n        setRuaCar(value);\n        break;\n\n      case \"numero\":\n        setNumeroCar(value);\n        break;\n\n      case \"complemento\":\n        setComplementoCar(value);\n        break;\n\n      case \"semana\":\n        setSemanaCar(value);\n        break;\n\n      case \"caucao\":\n        setCaucaoCar(value);\n        break;\n\n      case \"diaria\":\n        setDiariaCar(value);\n        break;\n\n      case \"cidade\":\n        setCidadeCar(value);\n        break;\n    }\n  };\n\n  const onFrontalChange = async event => {\n    const value = event.target.files[0];\n\n    if (value) {\n      setFrontalUrl(URL.createObjectURL(value));\n    }\n\n    setLoadingFrontal(true);\n    let formData = new FormData();\n    formData.append(\"file\", value);\n    const res = await createFile(formData);\n    setLoadingFrontal(false);\n\n    if (res) {\n      setFrontalId(res.id);\n    }\n  };\n\n  const onLateralDireitaChange = async event => {\n    const value = event.target.files[0];\n\n    if (value) {\n      setLateralDireitaUrl(URL.createObjectURL(value));\n    }\n\n    setLoadingLateralDireita(true);\n    let formData = new FormData();\n    formData.append(\"file\", value);\n    const res = await createFile(formData);\n    setLoadingLateralDireita(false);\n\n    if (res) {\n      setLateralDireitaId(res.id);\n    }\n  };\n\n  const onLateralEsquerdaChange = async event => {\n    const value = event.target.files[0];\n\n    if (value) {\n      setLateralEsquerdaUrl(URL.createObjectURL(value));\n    }\n\n    setLoadingLateralEsquerda(true);\n    let formData = new FormData();\n    formData.append(\"file\", value);\n    const res = await createFile(formData);\n    setLoadingLateralEsquerda(false);\n\n    if (res) {\n      setLateralEsquerdaId(res.id);\n    }\n  };\n\n  const onFundoChange = async event => {\n    const value = event.target.files[0];\n\n    if (value) {\n      setFundoUrl(URL.createObjectURL(value));\n    }\n\n    setLoadingFundo(true);\n    let formData = new FormData();\n    formData.append(\"file\", value);\n    const res = await createFile(formData);\n    setLoadingFundo(false);\n\n    if (res) {\n      setFundoId(res.id);\n    }\n  };\n\n  const onPainelInternoChange = async event => {\n    const value = event.target.files[0];\n\n    if (value) {\n      setPainelInternoUrl(URL.createObjectURL(value));\n    }\n\n    setLoadingPainelInterno(true);\n    let formData = new FormData();\n    formData.append(\"file\", value);\n    const res = await createFile(formData);\n    setLoadingPainelInterno(false);\n\n    if (res) {\n      setPainelInternoId(res.id);\n    }\n  };\n\n  const vehicleNextClick = () => {\n    if (!marcaCar || !modeloCar || !anoCar || !placaCar || !cepCar || !estadoCar || !cidadeCar || !ruaCar || !semanaCar || !caucaoCar) {\n      notify('error', 'Please check the input fields');\n    } else {\n      setActiveStep(prevActiveStep => prevActiveStep + 1);\n    }\n  };\n\n  const uploadCarDetails = async () => {\n    console.log('hi'); //debugger\n\n    setCarProcessing(true);\n    const data = await createCar({\n      marcaCar,\n      modeloCar,\n      anoCar,\n      placaCar,\n      cepCar,\n      estadoCar,\n      cidadeCar,\n      ruaCar,\n      semanaCar,\n      caucaoCar,\n      diariaCar,\n      numeroCar,\n      complementoCar,\n      bairroCar,\n      cidadeIdCar,\n      frontalId,\n      lateralDireitaId,\n      lateralEsquerdaId,\n      fundoId,\n      painelInternoId\n    });\n\n    if (data) {\n      console.log(\"updated data\", data);\n      notify('success', 'Car added successfully');\n    }\n\n    setCarProcessing(false); // setActiveStep(prevActiveStep => prevActiveStep + 1)\n  };\n\n  const getStepContent = step => {\n    switch (step) {\n      case 0:\n        return /*#__PURE__*/_jsx(PersonalInfo, {\n          activeStep: activeStep,\n          owner: {\n            nome,\n            email,\n            celular,\n            cpf,\n            cep,\n            estado,\n            bairro,\n            rua,\n            numero,\n            cidade,\n            complemento,\n            cidadeId\n          },\n          handleOwner: handleOwner,\n          personalNextClick: () => setActiveStep(prevActiveStep => prevActiveStep + 1),\n          processing: processing\n        });\n\n      case 1:\n        return /*#__PURE__*/_jsx(UploadPhotos, {\n          activeStep: activeStep,\n          owner: {\n            nome,\n            email,\n            celular,\n            cpf,\n            cep,\n            estado,\n            bairro,\n            rua,\n            numero,\n            cidade,\n            complemento,\n            cidadeId\n          },\n          prevOwner: owner,\n          personalNextClick: () => setActiveStep(prevActiveStep => prevActiveStep + 1),\n          uploadBack: () => setActiveStep(prevActiveStep => prevActiveStep - 1)\n        });\n\n      case 2:\n        return /*#__PURE__*/_jsx(VehicleDetails, {\n          marca: marcaCar,\n          modelo: modeloCar,\n          ano: anoCar,\n          placa: placaCar,\n          cep: cepCar,\n          estado: estadoCar,\n          cidade: cidadeCar,\n          rua: ruaCar,\n          semana: semanaCar,\n          caucao: caucaoCar,\n          diaria: diariaCar,\n          numero: numeroCar,\n          complemento: complementoCar,\n          bairro: bairroCar,\n          cidadeId: cidadeIdCar,\n          activeStep: activeStep,\n          handleCarInput: handleCarInput,\n          vehicleNextClick: vehicleNextClick,\n          vehicleBack: () => setActiveStep(prevActiveStep => prevActiveStep - 1)\n        });\n\n      case 3:\n        return /*#__PURE__*/_jsx(UploadVehiclePhotos, {\n          loadingFrontal: loadingFrontal,\n          frontalUrl: frontalUrl,\n          onFrontalChange: onFrontalChange,\n          loadingLateralDireita: loadingLateralDireita,\n          lateralDireitaUrl: lateralDireitaUrl,\n          onLateralDireitaChange: onLateralDireitaChange,\n          loadingLateralEsquerda: loadingLateralEsquerda,\n          lateralEsquerdaUrl: lateralEsquerdaUrl,\n          onLateralEsquerdaChange: onLateralEsquerdaChange,\n          loadingFundo: loadingFundo,\n          fundoUrl: fundoUrl,\n          onFundoChange: onFundoChange,\n          loadingPainelInterno: loadingPainelInterno,\n          painelInternoUrl: painelInternoUrl,\n          onPainelInternoChange: onPainelInternoChange,\n          activeStep: activeStep,\n          personalNextClick: () => setActiveStep(prevActiveStep => prevActiveStep + 1),\n          uploadBack: () => setActiveStep(prevActiveStep => prevActiveStep - 1),\n          processing: carProcessing,\n          uploadCarDetails: uploadCarDetails\n        });\n\n      default:\n        return null;\n    }\n  };\n\n  return /*#__PURE__*/_jsx(DashboardLayout, {\n    children: isLoading ? /*#__PURE__*/_jsx(FullPageLoader, {\n      loading: isLoading\n    }) : /*#__PURE__*/_jsxs(\"div\", {\n      className: \"supplier-reg-area mb-5\",\n      children: [/*#__PURE__*/_jsx(ToastContainer, {\n        style: {\n          zIndex: 99999\n        }\n      }), /*#__PURE__*/_jsx(\"h2\", {\n        className: \"text-primary mb-3\",\n        children: activeStep === 0 ? 'Meus dados' : activeStep === 1 ? 'Upload Fotos' : activeStep === 2 ? 'Dados do Veículo' : activeStep === 3 && 'Fotos do Veículo'\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"-12 d-flex justify-content-between mb-5 pb-3\",\n        children: [/*#__PURE__*/_jsxs(\"button\", {\n          className: `reg-step-btn ${activeStep === 0 ? 'reg-step-btn-active' : activeStep > 0 ? 'reg-step-btn-done' : ''}`,\n          onClick: () => setActiveStep(0),\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            className: \"reg-step-header\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            children: \"Dados Pessoais\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"button\", {\n          disabled: activeStep === 0 ? true : false,\n          className: `reg-step-btn ${activeStep === 1 ? 'reg-step-btn-active' : activeStep > 1 ? 'reg-step-btn-done' : ''}`,\n          onClick: () => setActiveStep(1),\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            className: \"reg-step-header\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            children: \"Upload Fotos\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"button\", {\n          className: `reg-step-btn ${activeStep === 2 ? 'reg-step-btn-active' : activeStep > 2 ? 'reg-step-btn-done' : ''}`,\n          onClick: () => setActiveStep(2),\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            className: \"reg-step-header\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            children: \"Dados do Ve\\xEDculo\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"button\", {\n          disabled: activeStep === 0 || 2 ? true : false,\n          className: `reg-step-btn ${activeStep === 3 ? 'reg-step-btn-active' : activeStep > 3 ? 'reg-step-btn-done' : ''}`,\n          onClick: () => setActiveStep(3),\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            className: \"reg-step-header\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            children: \"Fotos do Ve\\xEDculo\"\n          })]\n        })]\n      }), getStepContent(activeStep)]\n    })\n  });\n};\n\nexport default SupplierRegistrationForm;","map":null,"metadata":{},"sourceType":"module"}