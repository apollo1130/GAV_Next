{"ast":null,"code":"import _regeneratorRuntime from \"D:/gav(1)/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/gav(1)/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { config } from \"../config\";\nimport { REGISTER_FAIL, REGISTER_REQUEST, REGISTER_SUCCESS } from \"../constants/authConstant\";\nimport httpRequest from \"../utils/request\";\nimport { getSession } from \"next-auth/client\";\nimport axios from \"axios\";\nexport var registerService = function registerService(regObj, callback) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      var body, _yield$httpRequest$po, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch({\n                type: REGISTER_REQUEST\n              });\n              _context.prev = 1;\n              body = {\n                username: regObj.username,\n                password: regObj.password\n              };\n              _context.next = 5;\n              return httpRequest.post(\"\".concat(config.baseUrl, \"/register\"), false, null, body);\n\n            case 5:\n              _yield$httpRequest$po = _context.sent;\n              data = _yield$httpRequest$po.data;\n              dispatch({\n                type: REGISTER_SUCCESS,\n                payload: data\n              });\n              callback(data, null);\n              _context.next = 15;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](1);\n              dispatch({\n                type: REGISTER_FAIL,\n                payload: _context.t0.response\n              });\n              callback(null, _context.t0.response);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 11]]);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var loginService = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(service, token) {\n    var body, _yield$httpRequest$po2, data;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            console.log(\"token--------\" + token);\n            body = {\n              accessToken: token,\n              client_secret: config.GAV_CLIENT_SECRET,\n              client_id: config.GAV_CLIENT_ID,\n              pessoa_cadastro_id: 2\n            };\n            _context2.next = 5;\n            return httpRequest.post(\"\".concat(config.baseUrl, \"/api/auth/social/\").concat(service), false, null, body);\n\n          case 5:\n            _yield$httpRequest$po2 = _context2.sent;\n            data = _yield$httpRequest$po2.data;\n            console.log(data);\n            return _context2.abrupt(\"return\", data);\n\n          case 11:\n            _context2.prev = 11;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(\"error = ---/api/auth\");\n            console.log(_context2.t0.response.data.message);\n\n          case 15:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 11]]);\n  }));\n\n  return function loginService(_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var getMe = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    var session, token, _yield$axios$get, me;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return getSession();\n\n          case 3:\n            session = _context3.sent;\n\n            if (!session) {\n              _context3.next = 11;\n              break;\n            }\n\n            token = session.access_token;\n            _context3.next = 8;\n            return axios.get(\"\".concat(config.baseUrl, \"/api/me\"), {\n              headers: {\n                Authorization: \"Bearer \".concat(token),\n                Accept: \"application/json\"\n              }\n            });\n\n          case 8:\n            _yield$axios$get = _context3.sent;\n            me = _yield$axios$get.data;\n            return _context3.abrupt(\"return\", me);\n\n          case 11:\n            _context3.next = 17;\n            break;\n\n          case 13:\n            _context3.prev = 13;\n            _context3.t0 = _context3[\"catch\"](0);\n            console.log(_context3.t0);\n            return _context3.abrupt(\"return\", null);\n\n          case 17:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[0, 13]]);\n  }));\n\n  return function getMe() {\n    return _ref3.apply(this, arguments);\n  };\n}();","map":null,"metadata":{},"sourceType":"module"}