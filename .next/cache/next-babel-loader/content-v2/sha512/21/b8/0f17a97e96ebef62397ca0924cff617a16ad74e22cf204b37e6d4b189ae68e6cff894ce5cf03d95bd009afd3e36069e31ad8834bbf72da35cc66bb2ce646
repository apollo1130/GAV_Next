{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport { Dropdown } from \"react-bootstrap\";\nimport { FiSettings, FiSend } from \"react-icons/fi\";\nimport StarRatings from 'react-star-ratings';\nimport React, { useEffect, useState, useRef } from 'react';\nimport { getSession, session } from 'next-auth/client';\nimport Talk from \"talkjs\";\nimport PrimaryModal from \"./PrimaryModal\";\nimport { useRouter } from 'next/router';\nimport { Approved } from \"../../api/owner/approve\";\n\nconst ChatBox = ({\n  car\n}) => {\n  console.log('car', car);\n  const router = useRouter();\n  const {\n    0: show,\n    1: setShow\n  } = useState(false);\n  const {\n    0: talkSession,\n    1: setTalkSession\n  } = useState({});\n  const chatContainerRef = useRef(null);\n  const diaria = car && car.valor_diaria;\n  const carroId = car && car.carro_status_id;\n  useEffect(async () => {\n    const session = await getSession(); // console.log(\"id = \", car)\n    // console.log(session)\n    // var other = new Talk.User({\n    //     id: car ? car.proprietario_id: '',\n    //     name: \"ProprietÃ¡rio De Carro\",\n    //     welcomeMessage: \"Hey, how can I help?\"\n    // })\n\n    const s = await makeTalkSession();\n    setTalkSession(s); // const conversation = s.getOrCreateConversation(Talk.oneOnOneId(s.me, other))\n    // conversation.setParticipant(s.me)\n    // conversation.setParticipant(other)\n\n    const chatbox = s.createInbox(); //debugger\n\n    chatbox.mount(chatContainerRef.current);\n  }, []);\n\n  const makeTalkSession = async () => {\n    await Talk.ready;\n    const session = await getSession();\n    console.log(\"session - \", session);\n    const me = new Talk.User({\n      id: session.userId,\n      name: session.name,\n      photo: session.photo,\n      role: \"owner\"\n    });\n    return new Talk.Session({\n      appId: \"tEwRPl0c\",\n      me\n    });\n  };\n\n  const ApprovedThis = async () => {\n    const approved = await Approved(diaria, carroId);\n    console.log('approved', approved);\n\n    if (approved) {\n      router.push('/meus-veiculos');\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"my-panel-area__header\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"d-flex\",\n        children: [/*#__PURE__*/_jsx(\"p\", {\n          children: \"Antonio\"\n        }), /*#__PURE__*/_jsx(StarRatings, {\n          starDimension: \"15px\",\n          rating: 4,\n          starSpacing: \"5px\",\n          starRatedColor: \"white\",\n          starHoverColor: \"white\",\n          starEmptyColor: \"white\",\n          changeRating: rating => setRating(rating),\n          numberOfStars: 5,\n          name: \"rating\"\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"d-block ml-auto my-panel-area__icon custom-dropdown\",\n        children: /*#__PURE__*/_jsxs(Dropdown, {\n          drop: \"down\",\n          children: [/*#__PURE__*/_jsx(Dropdown.Toggle, {\n            id: \"dropdown-basic\",\n            children: /*#__PURE__*/_jsx(FiSettings, {})\n          }), /*#__PURE__*/_jsxs(Dropdown.Menu, {\n            children: [/*#__PURE__*/_jsx(Dropdown.Item, {\n              href: \"#/action-1\",\n              children: \"Bloquear\"\n            }), /*#__PURE__*/_jsx(Dropdown.Item, {\n              href: \"#/action-2\",\n              children: \"Denunciar\"\n            }), /*#__PURE__*/_jsx(Dropdown.Item, {\n              href: \"#/action-3\",\n              children: \"Var an\\xFAncio\"\n            })]\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"my-3 d-flex justify-content-between\",\n      children: /*#__PURE__*/_jsx(\"button\", {\n        onClick: () => setShow(true),\n        className: \"my-panel-area__btn mr-3\",\n        children: /*#__PURE__*/_jsx(\"p\", {\n          children: \"Aprovar\"\n        })\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"jsx-1925743923\" + \" \" + \"my-panel-area__chat\",\n      children: [/*#__PURE__*/_jsx(_JSXStyle, {\n        id: \"1925743923\",\n        children: [\".chat-container.jsx-1925743923{height:500px;}\"]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        ref: chatContainerRef,\n        className: \"jsx-1925743923\" + \" \" + \"chat-container\",\n        children: \"loading chat...\"\n      })]\n    }), /*#__PURE__*/_jsx(PrimaryModal, {\n      twoBtn: true,\n      aprovar: true,\n      show: show,\n      onclick: () => ApprovedThis(),\n      onClose: () => setShow(false),\n      title: \"Tem certeza de que deseja aprovar isso. Essa a\\xE7\\xE3o n\\xE3o pode ser desfeita!\"\n    })]\n  });\n};\n\nexport default ChatBox;","map":null,"metadata":{},"sourceType":"module"}