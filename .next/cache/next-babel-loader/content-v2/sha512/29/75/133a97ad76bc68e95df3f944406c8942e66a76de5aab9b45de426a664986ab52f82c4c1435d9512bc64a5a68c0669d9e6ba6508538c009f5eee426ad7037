{"ast":null,"code":"import { config } from \"../config\";\nimport { REGISTER_FAIL, REGISTER_REQUEST, REGISTER_SUCCESS } from \"../constants/authConstant\";\nimport httpRequest from \"../utils/request\";\nimport { getSession } from \"next-auth/client\";\nimport axios from \"axios\";\nexport const registerService = (regObj, callback) => async dispatch => {\n  dispatch({\n    type: REGISTER_REQUEST\n  });\n\n  try {\n    const body = {\n      username: regObj.username,\n      password: regObj.password\n    };\n    const {\n      data\n    } = await httpRequest.post(`${config.baseUrl}/register`, false, null, body);\n    dispatch({\n      type: REGISTER_SUCCESS,\n      payload: data\n    });\n    callback(data, null);\n  } catch (error) {\n    dispatch({\n      type: REGISTER_FAIL,\n      payload: error.response\n    });\n    callback(null, error.response);\n  }\n};\nexport const loginService = async (service, token) => {\n  //console.log(\"login service\", service, token)\n  try {\n    const body = {\n      accessToken: token,\n      client_secret: config.GAV_CLIENT_SECRET,\n      client_id: config.GAV_CLIENT_ID //pessoa_cadastro_id:  2,\n\n    };\n    const {\n      data\n    } = await httpRequest.post(`${config.baseUrl}/api/auth/social/${service}`, false, null, body);\n    return data;\n  } catch (error) {\n    console.log(\"error = ---/api/auth\");\n    console.log(error.response.data.message);\n  }\n};\nexport const getMe = async () => {\n  try {\n    const session = await getSession();\n\n    if (session) {\n      const token = session.access_token;\n      const {\n        data: me\n      } = await axios.get(`${config.baseUrl}/api/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\"\n        }\n      });\n      return me;\n    }\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n};","map":{"version":3,"sources":["D:/gav(1)/api/auth.js"],"names":["config","REGISTER_FAIL","REGISTER_REQUEST","REGISTER_SUCCESS","httpRequest","getSession","axios","registerService","regObj","callback","dispatch","type","body","username","password","data","post","baseUrl","payload","error","response","loginService","service","token","accessToken","client_secret","GAV_CLIENT_SECRET","client_id","GAV_CLIENT_ID","console","log","message","getMe","session","access_token","me","get","headers","Authorization","Accept"],"mappings":"AAAA,SAASA,MAAT,QAAuB,WAAvB;AACA,SACEC,aADF,EAEEC,gBAFF,EAGEC,gBAHF,QAIO,2BAJP;AAKA,OAAOC,WAAP,MAAwB,kBAAxB;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,eAAe,GAAG,CAACC,MAAD,EAASC,QAAT,KAAsB,MAAOC,QAAP,IAAoB;AACvEA,EAAAA,QAAQ,CAAC;AAAEC,IAAAA,IAAI,EAAET;AAAR,GAAD,CAAR;;AAEA,MAAI;AACF,UAAMU,IAAI,GAAG;AACXC,MAAAA,QAAQ,EAAEL,MAAM,CAACK,QADN;AAEXC,MAAAA,QAAQ,EAAEN,MAAM,CAACM;AAFN,KAAb;AAKA,UAAM;AAAEC,MAAAA;AAAF,QAAW,MAAMX,WAAW,CAACY,IAAZ,CACpB,GAAEhB,MAAM,CAACiB,OAAQ,WADG,EAErB,KAFqB,EAGrB,IAHqB,EAIrBL,IAJqB,CAAvB;AAOAF,IAAAA,QAAQ,CAAC;AACPC,MAAAA,IAAI,EAAER,gBADC;AAEPe,MAAAA,OAAO,EAAEH;AAFF,KAAD,CAAR;AAKAN,IAAAA,QAAQ,CAACM,IAAD,EAAO,IAAP,CAAR;AACD,GAnBD,CAmBE,OAAOI,KAAP,EAAc;AACdT,IAAAA,QAAQ,CAAC;AACPC,MAAAA,IAAI,EAAEV,aADC;AAEPiB,MAAAA,OAAO,EAAEC,KAAK,CAACC;AAFR,KAAD,CAAR;AAKAX,IAAAA,QAAQ,CAAC,IAAD,EAAOU,KAAK,CAACC,QAAb,CAAR;AACD;AACF,CA9BM;AAgCP,OAAO,MAAMC,YAAY,GAAG,OAAOC,OAAP,EAAgBC,KAAhB,KAA0B;AACpD;AACA,MAAI;AACF,UAAMX,IAAI,GAAG;AACXY,MAAAA,WAAW,EAAED,KADF;AAEXE,MAAAA,aAAa,EAAEzB,MAAM,CAAC0B,iBAFX;AAGXC,MAAAA,SAAS,EAAE3B,MAAM,CAAC4B,aAHP,CAIX;;AAJW,KAAb;AAOA,UAAM;AAAEb,MAAAA;AAAF,QAAW,MAAMX,WAAW,CAACY,IAAZ,CACpB,GAAEhB,MAAM,CAACiB,OAAQ,oBAAmBK,OAAQ,EADxB,EAErB,KAFqB,EAGrB,IAHqB,EAIrBV,IAJqB,CAAvB;AAMA,WAAOG,IAAP;AACD,GAfD,CAeE,OAAOI,KAAP,EAAc;AACdU,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYX,KAAK,CAACC,QAAN,CAAeL,IAAf,CAAoBgB,OAAhC;AACD;AACF,CArBM;AAuBP,OAAO,MAAMC,KAAK,GAAG,YAAY;AAC/B,MAAI;AACF,UAAMC,OAAO,GAAG,MAAM5B,UAAU,EAAhC;;AACA,QAAI4B,OAAJ,EAAa;AACX,YAAMV,KAAK,GAAGU,OAAO,CAACC,YAAtB;AACA,YAAM;AAAEnB,QAAAA,IAAI,EAAEoB;AAAR,UAAe,MAAM7B,KAAK,CAAC8B,GAAN,CAAW,GAAEpC,MAAM,CAACiB,OAAQ,SAA5B,EAAsC;AAC/DoB,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAG,UAASf,KAAM,EADxB;AAEPgB,UAAAA,MAAM,EAAE;AAFD;AADsD,OAAtC,CAA3B;AAMA,aAAOJ,EAAP;AACD;AACF,GAZD,CAYE,OAAOhB,KAAP,EAAc;AACdU,IAAAA,OAAO,CAACC,GAAR,CAAYX,KAAZ;AACA,WAAO,IAAP;AACD;AACF,CAjBM","sourcesContent":["import { config } from \"../config\";\nimport {\n  REGISTER_FAIL,\n  REGISTER_REQUEST,\n  REGISTER_SUCCESS,\n} from \"../constants/authConstant\";\nimport httpRequest from \"../utils/request\";\nimport { getSession } from \"next-auth/client\";\nimport axios from \"axios\";\n\nexport const registerService = (regObj, callback) => async (dispatch) => {\n  dispatch({ type: REGISTER_REQUEST });\n\n  try {\n    const body = {\n      username: regObj.username,\n      password: regObj.password,\n    };\n\n    const { data } = await httpRequest.post(\n      `${config.baseUrl}/register`,\n      false,\n      null,\n      body\n    );\n\n    dispatch({\n      type: REGISTER_SUCCESS,\n      payload: data,\n    });\n\n    callback(data, null);\n  } catch (error) {\n    dispatch({\n      type: REGISTER_FAIL,\n      payload: error.response,\n    });\n\n    callback(null, error.response);\n  }\n};\n\nexport const loginService = async (service, token) => {\n  //console.log(\"login service\", service, token)\n  try {\n    const body = {\n      accessToken: token,\n      client_secret: config.GAV_CLIENT_SECRET,\n      client_id: config.GAV_CLIENT_ID,\n      //pessoa_cadastro_id:  2,\n    };\n\n    const { data } = await httpRequest.post(\n      `${config.baseUrl}/api/auth/social/${service}`,\n      false,\n      null,\n      body\n    );\n    return data;\n  } catch (error) {\n    console.log(\"error = ---/api/auth\");\n    console.log(error.response.data.message);\n  }\n};\n\nexport const getMe = async () => {\n  try {\n    const session = await getSession();\n    if (session) {\n      const token = session.access_token;\n      const { data: me } = await axios.get(`${config.baseUrl}/api/me`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n        },\n      });\n      return me;\n    }\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n};\n"]},"metadata":{},"sourceType":"module"}