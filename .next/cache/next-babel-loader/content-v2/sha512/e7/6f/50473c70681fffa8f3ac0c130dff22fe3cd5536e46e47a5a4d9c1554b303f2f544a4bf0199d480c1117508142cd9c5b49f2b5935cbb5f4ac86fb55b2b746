{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"D:/gav(1)/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/gav(1)/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport { Dropdown } from \"react-bootstrap\";\nimport { FiSettings, FiSend } from \"react-icons/fi\";\nimport StarRatings from 'react-star-ratings';\nimport React, { useEffect, useState, useRef } from 'react';\nimport { getSession, session } from 'next-auth/client';\nimport Talk from \"talkjs\";\nimport PrimaryModal from \"./PrimaryModal\";\nimport { useRouter } from 'next/router';\nimport { Approved } from \"../../api/owner/approve\";\n\nvar ChatBox = function ChatBox(_ref) {\n  var car = _ref.car;\n  console.log('car', car);\n  var router = useRouter();\n\n  var _useState = useState(false),\n      show = _useState[0],\n      setShow = _useState[1];\n\n  var _useState2 = useState({}),\n      talkSession = _useState2[0],\n      setTalkSession = _useState2[1];\n\n  var chatContainerRef = useRef(null);\n  var diaria = car && car.valor_diaria;\n  var carroId = car && car.carro_status_id;\n  useEffect( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var session, s, chatbox;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return getSession();\n\n          case 2:\n            session = _context.sent;\n            _context.next = 5;\n            return makeTalkSession();\n\n          case 5:\n            s = _context.sent;\n            setTalkSession(s); // const conversation = s.getOrCreateConversation(Talk.oneOnOneId(s.me, other))\n            // conversation.setParticipant(s.me)\n            // conversation.setParticipant(other)\n\n            chatbox = s.createInbox(); //debugger\n\n            chatbox.mount(chatContainerRef.current);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n\n  var makeTalkSession = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var session, me;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return Talk.ready;\n\n            case 2:\n              _context2.next = 4;\n              return getSession();\n\n            case 4:\n              session = _context2.sent;\n              console.log(\"session - \", session);\n              me = new Talk.User({\n                id: session.userId,\n                name: session.name,\n                photo: session.photo,\n                role: \"owner\"\n              });\n              return _context2.abrupt(\"return\", new Talk.Session({\n                appId: \"tEwRPl0c\",\n                me: me\n              }));\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function makeTalkSession() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var ApprovedThis = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var approved;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return Approved(diaria, carroId);\n\n            case 2:\n              approved = _context3.sent;\n              console.log('approved', approved);\n\n              if (approved) {\n                router.push('/meus-veiculos');\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function ApprovedThis() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"my-panel-area__header\",\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"d-flex\",\n        children: [/*#__PURE__*/_jsx(\"p\", {\n          children: \"Antonio\"\n        }), /*#__PURE__*/_jsx(StarRatings, {\n          starDimension: \"15px\",\n          rating: 4,\n          starSpacing: \"5px\",\n          starRatedColor: \"white\",\n          starHoverColor: \"white\",\n          starEmptyColor: \"white\",\n          changeRating: function changeRating(rating) {\n            return setRating(rating);\n          },\n          numberOfStars: 5,\n          name: \"rating\"\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"d-block ml-auto my-panel-area__icon custom-dropdown\",\n        children: /*#__PURE__*/_jsxs(Dropdown, {\n          drop: \"down\",\n          children: [/*#__PURE__*/_jsx(Dropdown.Toggle, {\n            id: \"dropdown-basic\",\n            children: /*#__PURE__*/_jsx(FiSettings, {})\n          }), /*#__PURE__*/_jsxs(Dropdown.Menu, {\n            children: [/*#__PURE__*/_jsx(Dropdown.Item, {\n              href: \"#/action-1\",\n              children: \"Bloquear\"\n            }), /*#__PURE__*/_jsx(Dropdown.Item, {\n              href: \"#/action-2\",\n              children: \"Denunciar\"\n            }), /*#__PURE__*/_jsx(Dropdown.Item, {\n              href: \"#/action-3\",\n              children: \"Var an\\xFAncio\"\n            })]\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"my-3 d-flex justify-content-between\",\n      children: /*#__PURE__*/_jsx(\"button\", {\n        onClick: function onClick() {\n          return setShow(true);\n        },\n        className: \"my-panel-area__btn mr-3\",\n        children: /*#__PURE__*/_jsx(\"p\", {\n          children: \"Aprovar\"\n        })\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"jsx-1925743923\" + \" \" + \"my-panel-area__chat\",\n      children: [/*#__PURE__*/_jsx(_JSXStyle, {\n        id: \"1925743923\",\n        children: [\".chat-container.jsx-1925743923{height:500px;}\"]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        ref: chatContainerRef,\n        className: \"jsx-1925743923\" + \" \" + \"chat-container\",\n        children: \"loading chat...\"\n      })]\n    }), /*#__PURE__*/_jsx(PrimaryModal, {\n      twoBtn: true,\n      aprovar: true,\n      show: show,\n      onclick: function onclick() {\n        return ApprovedThis();\n      },\n      onClose: function onClose() {\n        return setShow(false);\n      },\n      title: \"Tem certeza de que deseja aprovar isso. Essa a\\xE7\\xE3o n\\xE3o pode ser desfeita!\"\n    })]\n  });\n};\n\nexport default ChatBox;","map":null,"metadata":{},"sourceType":"module"}