{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport DashboardLayout from '../../layouts/Dashboard';\nimport { useState, useEffect } from \"react\";\nimport PersonalInfo from '../../components/DriverRegistration/PersonalInfo';\nimport UploadPhotos from '../../components/DriverRegistration/UploadPhotos';\nimport { recoverDriver } from '../../api/driver/recoverDriver';\nimport { updateDriver, getCep } from '../../api/driver/updateDriver';\nimport { useInput } from \"../../utils/common\";\n\nconst DriverRegistrationForm = () => {\n  const {\n    0: activeStep,\n    1: setActiveStep\n  } = useState(0);\n  const {\n    0: isLodding,\n    1: setLodding\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(\"\");\n  const {\n    0: exDriver,\n    1: setExDriver\n  } = useState({});\n  const {\n    0: nome,\n    1: setnome\n  } = useState(\"\");\n  const {\n    0: email,\n    1: setemail\n  } = useState(\"\");\n  const {\n    0: celular,\n    1: setcelular\n  } = useState(\"\");\n  const {\n    0: cpf,\n    1: setcpf\n  } = useState(\"\");\n  const {\n    0: cep,\n    1: setcep\n  } = useState(\"\");\n  const {\n    0: estado,\n    1: setestado\n  } = useState(\"\");\n  const {\n    0: bairro,\n    1: setbairro\n  } = useState(\"\");\n  const {\n    0: rua,\n    1: setrua\n  } = useState(\"\");\n  const {\n    0: numero,\n    1: setnumero\n  } = useState(\"\");\n  const {\n    0: cidade,\n    1: setcidade\n  } = useState(\"\");\n  const {\n    0: complemento,\n    1: setcomplemento\n  } = useState(\"\");\n  const {\n    0: cidadeId,\n    1: setCidadeId\n  } = useState(\"\");\n\n  const changeDriver = async e => {\n    const name = e.target.name;\n    const value = e.target.value;\n\n    switch (name) {\n      case \"nome\":\n        setnome(value);\n        break;\n\n      case \"email\":\n        setemail(value);\n        break;\n\n      case \"celular\":\n        setcelular(value);\n        break;\n\n      case \"cpf\":\n        setcpf(value);\n        break;\n\n      case \"cep\":\n        console.log(\"value = \", value);\n        setcep(value);\n        setLodding(true);\n        const addr = await getCep(value);\n\n        if (addr) {\n          console.log(\"add = \", addr);\n          setbairro(addr.bairro);\n          setrua(addr.logradouro);\n          setcidade(addr.cidade.descricao);\n          setestado(addr.cidade.estado.descricao);\n          setCidadeId(addr.cidade.id);\n        }\n\n        setLodding(false);\n        break;\n\n      case \"estado\":\n        setestado(value);\n        break;\n\n      case \"bairro\":\n        setbairro(value);\n        break;\n\n      case \"rua\":\n        setrua(value);\n        break;\n\n      case \"cidade\":\n        setcidade(value);\n        break;\n\n      case \"numero\":\n        setnumero(value);\n        break;\n\n      case \"complemento\":\n        setcomplemento(value);\n        break;\n    }\n  };\n\n  useEffect(async () => {\n    setLodding(true);\n    const data = await recoverDriver(() => {\n      setLodding(false);\n    });\n\n    if (data) {\n      console.log(data);\n      setExDriver(data);\n      setnome(data.nome);\n      setemail(data.email);\n      setcelular(data.celular);\n\n      if (data.pessoa_fisica && data.pessoa_fisica.cpf) {\n        setcpf(data.pessoa_fisica.cpf);\n      }\n\n      if (data.endereco.length) {\n        const addr = data.endereco[0];\n\n        if (addr.cidade && addr.cidade.descricao) {\n          setcidade(addr.cidade.descricao);\n          setCidadeId(addr.cidade.id);\n        }\n\n        if (addr.cidade && addr.cidade.estado && addr.cidade.estado.descricao) {\n          setestado(addr.cidade.estado.descricao);\n        }\n\n        if (addr.cep) {\n          setcep(addr.cep);\n        }\n\n        if (addr.bairro) {\n          setbairro(addr.bairro);\n        }\n\n        if (addr.logradouro) {\n          setrua(addr.logradouro);\n        }\n\n        if (addr.numero) {\n          setnumero(addr.numero);\n        }\n\n        if (addr.complemento) {\n          setcomplemento(addr.complemento);\n        }\n      }\n    }\n  }, []);\n\n  const clickAndNext = async () => {\n    //const updated = await updateDriver({ nome, email, celular, cpf, cep, estado, bairro, rua, numero, cidade, complemento, cidadeId }, exDriver)\n    //if(updated){\n    setActiveStep(prevActiveStep => prevActiveStep + 1); //}\n  };\n\n  const getStepContent = step => {\n    switch (step) {\n      case 0:\n        return /*#__PURE__*/_jsx(PersonalInfo, {\n          activeStep: activeStep,\n          driver: {\n            nome,\n            email,\n            celular,\n            cpf,\n            cep,\n            estado,\n            bairro,\n            rua,\n            numero,\n            cidade,\n            complemento\n          },\n          changeDriver: changeDriver,\n          personalNextClick: clickAndNext\n        });\n\n      case 1:\n        return /*#__PURE__*/_jsx(UploadPhotos, {\n          driver: {\n            nome,\n            email,\n            celular,\n            cpf,\n            cep,\n            estado,\n            bairro,\n            rua,\n            numero,\n            cidade,\n            complemento\n          },\n          activeStep: activeStep,\n          prevDriver: exDriver,\n          uploadBack: () => setActiveStep(prevActiveStep => prevActiveStep - 1)\n        });\n\n      default:\n        return null;\n    }\n  };\n\n  return /*#__PURE__*/_jsx(DashboardLayout, {\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"supplier-reg-area mb-5\",\n      children: [/*#__PURE__*/_jsx(\"h2\", {\n        className: \"text-primary mb-3\",\n        children: activeStep === 0 ? 'Meus dados' : activeStep === 1 && 'Upload Fotos'\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"d-flex mb-5 pb-3\",\n        children: [/*#__PURE__*/_jsxs(\"button\", {\n          className: `reg-step-btn w-auto pr-5 ${activeStep === 0 ? 'reg-step-btn-active' : activeStep > 0 ? 'reg-step-btn-done' : ''}`,\n          onClick: () => setActiveStep(0),\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            className: \"reg-step-header\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            children: \"Dados Pessoais\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"button\", {\n          className: `reg-step-btn w-auto ${activeStep === 1 ? 'reg-step-btn-active' : activeStep > 1 ? 'reg-step-btn-done' : ''}`,\n          onClick: () => setActiveStep(1),\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            className: \"reg-step-header\"\n          }), /*#__PURE__*/_jsx(\"span\", {\n            children: \"Upload Fotos\"\n          })]\n        })]\n      }), getStepContent(activeStep)]\n    })\n  });\n};\n\nexport default DriverRegistrationForm;","map":null,"metadata":{},"sourceType":"module"}